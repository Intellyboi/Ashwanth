<!DOCTYPE html>
<html>
<head>
  <title>BMS</title>
  <link rel="icon" href="full-green-3d-battery-icon-png.webp"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"></link>
  <link rel="javascript" href="index.js"></link>
  <link rel="stylesheet" href="index.css"></link>
  <script src=”https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js”></script>
  <script src=”https://cdnjs.cloudflare.com/ajax/libs/easy-pie-chart/2.1.6/jquery.easypiechart.min.js”></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" ></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body id="wholepg">
    <header class="BMS">BMS MONITOR</header>
    <div class="Bars">
      <div role="progressbar" aria-valuenow="SOC" aria-valuemin="0" aria-valuemax="100" style="--value:65"></div>
      <div role="progressbar" aria-valuenow="Sumvolt" aria-valuemin="0" aria-valuemax="100" style="--value:31"></div>
      <div role="progressbar" aria-valuenow="Capacity" aria-valuemin="0" aria-valuemax="100" style="--value:49"></div>
      <div style="margin-left:4em;">SOC</div>
      <div style="margin-left:3.5em;">Sumvolt</div>
      <div style="margin-left:3.5em;">Capacity</div>
    </div>
    <div class="Progress_Bars">
    <div class="row">
      <div class="column">
        <table>
          <tr>
            <th><img style="width:40%; height:40%;" src="Power.png"></th>
            <th><h2><div class="text">Voltage</div><h2></th>
            <td><progress id='SOC' value='23' max='100'></progress></td>
            <th><h2><div class="text">V</div><h2></th>
          </tr>
          <tr>
            <td><img style="width:40%; height:40%;" src="charge.png"></td>
            <th><h2><div class="text">Capacity</div><h2></th>
            <td><progress id='p1' value='36' max='100'></progress></td>
            <td><h2><div class="text">Ah</div><h2></td>
          </tr>
          <tr>
            <td><img style="width:40%; height:40%;" src="Temp.png"></td>
            <th><h2><div class="text">Max Temp</div><h2></th>
            <td><progress id='p2' value='23' max='100'></progress></td>
            <td><h2><div class="text">C</div></h2></td>
          </tr>
          <tr>
          </tr>
          <tr>
          </tr>
        </table>
      </div>
      <div class="column">
        <table>
          <tr>
            <th><img style="width:40%; height:40%;" src="Power.png"></th>
            <th><h2><div class="text">Current</div><h2></th>
              <th><progress id='p3' value='Current' max='100'></progress></th>
            <th><h2><div class="text">A</div></h2></th>
          </tr>
          <tr>
            <td><img style="width:40%; height:40%;" src="charge.png"></td>
            <th><h2><div class="text">SOC</div><h2></th>
              <td><progress id='p4' value='78' max='100'></progress></td>
            <td><h2><div class="text">%</div></h2></td>
          </tr>
          <tr>
            <td><img style="width:40%; height:40%;" src="Temp.png"></td>
            <th><h2><div class="text">Min Temp</div><h2></th>
            <td>  <progress id='p5' value='67' max='100'></progress></td>
            <td><h2><div class="text">C</div></h2></td>
          </tr>
          <tr>
          </tr>
        </table>
      </div>
    </div>
  </div><br><br><br><br><br><br><br><br>

    
  
  <body>

  <br><br><br><br>

  <div class="Cell_Info">
    
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C1" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C2" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C1" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C4" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C5" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C6" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C7" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C8" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C9" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C10" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C11" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C12" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C13" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C14" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C15" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C16" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C17" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C18" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    <div><figure class="battery"></figure>
      <span style="margin-left:2em;">Voltage : &ensp;&ensp;&ensp;&ensp;&ensp;<input readonly id="C19" type = "text"></span><br>
      <span style="margin-left:2em;">Balance State:&ensp;<input readonly id="C3" type = "text"></span><br>
      <span style="margin-left:2em;"> Temperature:&ensp;&nbsp;<input readonly id="C3" type = "text"></span>
    </div>
    
    </div>

    
 









  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyBX1IurW-DEPL5lv6ulOJvS_Wzw3Yg_8gc",
      authDomain: "smartbms-b6354.firebaseapp.com",
      databaseURL: "https://smartbms-b6354-default-rtdb.firebaseio.com",
      projectId: "smartbms-b6354",
      storageBucket: "smartbms-b6354.appspot.com",
      messagingSenderId: "418880758978",
      appId: "1:418880758978:web:0ae0409718579c87c8c75b",
      measurementId: "G-PQYGG1K6FR"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    import {getDatabase, get, child, ref} from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js"

    const db = getDatabase();
    const dbref = ref(db);

    var sums = document.getElementById("Sumvolt");
    var remcap = document.getElementById("Remc");
    var maxte = document.getElementById("Maxt");
    var curr = document.getElementById("Current");
    var Soc1 = document.getElementById("SOC");
    var minte = document.getElementById("Mint");

    var cv1 = document.getElementById("C1");
    var cv2 = document.getElementById("C2");
    var cv3 = document.getElementById("C3");
    var cv4 = document.getElementById("C4");
    var cv5 = document.getElementById("C5");
    var cv6 = document.getElementById("C6");
    var cv7 = document.getElementById("C7");
    var cv8 = document.getElementById("C8");
    var cv9 = document.getElementById("C9");
    var cv10 = document.getElementById("C10");
    var cv11 = document.getElementById("C11");
    var cv12 = document.getElementById("C12");
    var cv13 = document.getElementById("C13");
    var cv14 = document.getElementById("C14");
    var cv15 = document.getElementById("C15");
    var cv16 = document.getElementById("C16");
    var cv17 = document.getElementById("C17");
    var cv18 = document.getElementById("C18");
    var cv19 = document.getElementById("C19");

    let line1,line2,line3,line4;

    get(child(dbref,"90")).then((snapshot)=>{
      line1 = snapshot.val().slice(8);
      sums.value = Number.parseInt(line1.slice(0, 4), 16) * 0.1;
      curr.value = Number.parseInt(line1.slice(8, 12), 16) * 0.1 - 3000;
      Soc1.value = Number.parseInt(line1.slice(12, 16), 16) * 0.1;
    });

    get(child(dbref,"92")).then((snapshot)=>{
      line2 = snapshot.val().slice(8);
      maxte.value = Number.parseInt(line2.slice(0, 2), 16) - 40;
      minte.value = Number.parseInt(line2.slice(4, 6), 16) - 40;
    });

    get(child(dbref,"93")).then((snapshot)=>{
      line3 = snapshot.val().slice(8);
      remcap.value = Number.parseInt(line3.slice(8, 16), 16) * 0.001;
    });

    get(child(dbref,"95")).then((snapshot)=>{
      line4 = snapshot.val();
      cv1.value = Number.parseInt(line4.slice(10, 14), 16) * 0.001
      cv2.value = Number.parseInt(line4.slice(14, 18), 16) * 0.001
      cv3.value = Number.parseInt(line4.slice(18, 22), 16) * 0.001
      cv4.value = Number.parseInt(line4.slice(36, 40), 16) * 0.001
      cv5.value = Number.parseInt(line4.slice(40, 44), 16) * 0.001
      cv6.value = Number.parseInt(line4.slice(44, 48), 16) * 0.001
      cv7.value = Number.parseInt(line4.slice(62, 66), 16) * 0.001
      cv8.value = Number.parseInt(line4.slice(66, 70), 16) * 0.001
      cv9.value = Number.parseInt(line4.slice(70 ,74), 16) * 0.001
      cv10.value = Number.parseInt(line4.slice(88, 92), 16) * 0.001
      cv11.value = Number.parseInt(line4.slice(92, 96), 16) * 0.001
      cv12.value = Number.parseInt(line4.slice(96, 100), 16) * 0.001
      cv13.value = Number.parseInt(line4.slice(114, 118), 16) * 0.001
      cv14.value = Number.parseInt(line4.slice(118, 122), 16) * 0.001
      cv15.value = Number.parseInt(line4.slice(122, 126), 16) * 0.001
      cv16.value = Number.parseInt(line4.slice(140, 144), 16) * 0.001
      cv17.value = Number.parseInt(line4.slice(144, 148), 16) * 0.001
      cv18.value = Number.parseInt(line4.slice(148, 152), 16) * 0.001
      cv19.value = Number.parseInt(line4.slice(166, 170), 16) * 0.001
    });

  </script>

  </body>
  </html>
